---
layout: default
---
{{ content }}
<div id="pageList" style="display: none;">
    <center>
        <input type="button" value="Back" onclick="page((document.getElementById('pageSelect').value)-1)"> 
        <input class="numhidden" type="number" id="pageSelect" min="1" max="999" onchange="page(document.getElementById('pageSelect').value)"> 
        <input type="button" value="Next" onclick="page((document.getElementById('pageSelect').value)+1)">
    </center>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
    <div name="pageList-item"></div>
</div>
<p id="data-info" style="display: none;"></p>
<script name="abcd1337">
    // Remove self
    const elem = document.currentScript || document.getElementById("abcd1337");
    elem.parentNode.removeChild(elem);

    // Get Query [https://stackoverflow.com/questions/647259/javascript-query-string]
    var queryResult = {}
    function getParams() {
        let queryString = location.search.slice(1), queryRegex = /([^/?&=]+)=([^&]*)/g, queryMatch;
        while (queryMatch = queryRegex.exec(queryString)) {
            queryResult[decodeURIComponent(queryMatch[1])] = decodeURIComponent(queryMatch[2]);
        }
    }

    // Set Data
    function setPage() {
        getParams();
        document.getElementById("pageList").style.display = "block";
        let pagelist = document.getElementsByName("pageList-item");

        let curPage = parseInt(queryResult["page"], 10) - 1;
        curPage = Math.min(Math.max(curPage, 0), Math.floor((pageList_data.length - 1)/pagelist.length)) || 0;

        let pageOffset = curPage * (pagelist.length);
        let pagelist_spacer = "<br><br>";
        for(let i = 0; i < pagelist.length; i++) {
            if (i+pageOffset >= pageList_data.length) {
                pagelist[i].innerHTML = '';
            } else {
                let pageData = pageList_data[i+pageOffset];
                if (i+pageOffset == pageList_data.length - 1 || i == pagelist.length - 1) pagelist_spacer = "";
                pagelist[i].innerHTML = `<a href="${pageData.id}" style="font-size: 1.5rem;">${i+pageOffset+1}. ${pageData.title}</a><br> ${pageData.description} ${pagelist_spacer}`;
            } 
        }
        
        // Update the select page if its not the correct page already
        if (document.getElementById('pageSelect').value != curPage+1) document.getElementById('pageSelect').value = curPage+1;
        // Fix the page url if the page exceeds the maxpage available
        if ((parseInt(queryResult["page"], 10) || 0) != curPage+1) history.replaceState(null, null, `?page=${curPage+1}`);
    }
    // get Pagelist
    let pageList_data = new XMLHttpRequest();
    pageList_data.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        pageList_data = JSON.parse(this.responseText).reverse();
        pageList_data.shift();
        // document.getElementById("data-info").innerHTML = JSON.stringify(data); // debug
        // document.getElementById("data-info").style.display = "block";
        document.getElementById("pageList").style.display = "block";
        setPage();
    } else if (this.readyState == 4 && this.status != 200) {
        document.getElementById("data-info").innerHTML = `An error has occured (${this.status})`
        document.getElementById("data-info").style.display = "block";
    }
    };
    pageList_data.open("GET", `{{page.permalink}}/pages.json`, true);
    pageList_data.send();

    function page(number){
        history.replaceState(null, null, `?page=${number}`);
        setPage();
    }
</script>