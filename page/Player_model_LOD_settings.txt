<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Why.3F"><span class="tocnumber">1</span> <span class="toctext">Why?</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#How.3F"><span class="tocnumber">2</span> <span class="toctext">How?</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Recommended_reading"><span class="tocnumber">3</span> <span class="toctext">Recommended reading</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#LOD_0"><span class="tocnumber">4</span> <span class="toctext">LOD 0</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#LOD_1"><span class="tocnumber">5</span> <span class="toctext">LOD 1</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#LOD_2"><span class="tocnumber">6</span> <span class="toctext">LOD 2</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#LOD_3"><span class="tocnumber">7</span> <span class="toctext">LOD 3</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Lowest_LODs"><span class="tocnumber">8</span> <span class="toctext">Lowest LODs</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Shadow_LOD"><span class="tocnumber">8.1</span> <span class="toctext">Shadow LOD</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Why.3F">Why?</span></h1>
<p>In the vast majority of cases, the main source of slowdown in multiplayer servers with lots of players is the amount of bones that have to be processed by the Source engine.
</p><p>We can use a number of tricks to mitigate this aspect such as removing finger bones when you're far away enough.
</p>
<h1> <span class="mw-headline" id="How.3F">How?</span></h1>
<p>Any QC includes (QCI files) that are referenced here can be found in the public Source SDK example files, which are located at Steam/SteamApps/your Steam username/sourcesdk_content/hl2/modelsrc/humans_sdk.
</p><p>Even if you have made no LOD meshes that reduce the polygon count of your player model, you should apply these LOD commands, since they will drastically reduce bone counts at a distance, helping with performance.
</p><p>The LOD settings that follow are used by almost all of the player models that ship with Garry's Mod.
</p>
<h1> <span class="mw-headline" id="Recommended_reading"> Recommended reading </span></h1>
<ul><li> <a rel="nofollow" class="external free" href="https://developer.valvesoftware.com/wiki/LOD_Models">https://developer.valvesoftware.com/wiki/LOD_Models</a>
</li><li> <a rel="nofollow" class="external free" href="https://developer.valvesoftware.com/wiki/$lod">https://developer.valvesoftware.com/wiki/$lod</a>
</li></ul>
<h1> <span class="mw-headline" id="LOD_0"> LOD 0 </span></h1>
<p>No optimizations yet, since this is the highest level of detail.
</p>
<h1> <span class="mw-headline" id="LOD_1"> LOD 1 </span></h1>
<p><b>Recommended distance:</b> 9
</p>
<pre><code data-language="lua"> replacemodel "my_detailed_mesh.smd" "my_less_detailed_mesh_for_this_lod.smd"
 replacebone "ValveBiped.Bip01_L_Elbow" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Elbow" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Ulna" "ValveBiped.Bip01_L_Forearm"
 replacebone "ValveBiped.Bip01_R_Ulna" "ValveBiped.Bip01_R_Forearm"
 replacebone "ValveBiped.Bip01_L_Wrist" "ValveBiped.Bip01_L_Forearm"
 replacebone "ValveBiped.Bip01_R_Wrist" "ValveBiped.Bip01_R_Forearm"
 replacebone "ValveBiped.Bip01_L_Bicep" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Bicep" "ValveBiped.Bip01_R_upperarm"
 
 replacebone "ValveBiped.Bip01_L_Finger02" "ValveBiped.Bip01_L_Finger01"
 replacebone "ValveBiped.Bip01_L_Finger12" "ValveBiped.Bip01_L_Finger11"
 replacebone "ValveBiped.Bip01_L_Finger22" "ValveBiped.Bip01_L_Finger21"
 replacebone "ValveBiped.Bip01_L_Finger32" "ValveBiped.Bip01_L_Finger31"
 replacebone "ValveBiped.Bip01_L_Finger42" "ValveBiped.Bip01_L_Finger41"
 
 replacebone "ValveBiped.Bip01_R_Finger02" "ValveBiped.Bip01_R_Finger01"
 replacebone "ValveBiped.Bip01_R_Finger12" "ValveBiped.Bip01_R_Finger11"
 replacebone "ValveBiped.Bip01_R_Finger22" "ValveBiped.Bip01_R_Finger21"
 replacebone "ValveBiped.Bip01_R_Finger32" "ValveBiped.Bip01_R_Finger31"
 replacebone "ValveBiped.Bip01_R_Finger42" "ValveBiped.Bip01_R_Finger41"
</code></pre>
<p>This removes some of the procedural bones as well as the tip of the fingers.
</p>
<h1> <span class="mw-headline" id="LOD_2"> LOD 2 </span></h1>
<p><b>Recommended distance:</b> 18
</p>
<pre><code data-language="lua"> replacemodel "my_detailed_mesh.smd" "my_less_detailed_mesh_for_this_lod.smd"
 nofacial
 bonetreecollapse "ValveBiped.Bip01_L_Hand"
 bonetreecollapse "ValveBiped.Bip01_R_Hand"
 
 replacebone "ValveBiped.Bip01_L_Elbow" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Elbow" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Ulna" "ValveBiped.Bip01_L_Forearm"
 replacebone "ValveBiped.Bip01_R_Ulna" "ValveBiped.Bip01_R_Forearm"
 replacebone "ValveBiped.Bip01_L_Shoulder" "ValveBiped.Bip01_L_upperarm"  
 replacebone "ValveBiped.Bip01_R_Shoulder" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Trapezius" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Trapezius" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Wrist" "ValveBiped.Bip01_L_Forearm"
 replacebone "ValveBiped.Bip01_R_Wrist" "ValveBiped.Bip01_R_Forearm"
 replacebone "ValveBiped.Bip01_L_Bicep" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Bicep" "ValveBiped.Bip01_R_upperarm"
</code></pre>
<p>This disables facial animation, removes almost all procedural bones, and gets rid of fingers.
</p>
<h1> <span class="mw-headline" id="LOD_3"> LOD 3 </span></h1>
<p><b>Recommended distance:</b> 32
</p>
<pre><code data-language="lua"> $include "../../removehands.qci"
</code></pre>
<pre><code data-language="lua"> replacemodel "my_detailed_mesh.smd" "my_less_detailed_mesh_for_this_lod.smd"
 removemesh "eyeball material, etc"
       
 nofacial
 bonetreecollapse "ValveBiped.Bip01_L_Forearm"
 bonetreecollapse "ValveBiped.Bip01_R_Forearm"
 bonetreecollapse "ValveBiped.Bip01_L_Calf"
 bonetreecollapse "ValveBiped.Bip01_R_Calf"
 replacebone "ValveBiped.Bip01_L_Elbow" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Elbow" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Ulna" "ValveBiped.Bip01_L_Forearm"
 replacebone "ValveBiped.Bip01_R_Ulna" "ValveBiped.Bip01_R_Forearm"
 replacebone "ValveBiped.Bip01_L_Shoulder" "ValveBiped.Bip01_L_upperarm"  
 replacebone "ValveBiped.Bip01_R_Shoulder" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Trapezius" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Trapezius" "ValveBiped.Bip01_R_upperarm"
 replacebone "ValveBiped.Bip01_L_Wrist" "ValveBiped.Bip01_L_Forearm"
 replacebone "ValveBiped.Bip01_R_Wrist" "ValveBiped.Bip01_R_Forearm"
 replacebone "ValveBiped.Bip01_L_Bicep" "ValveBiped.Bip01_L_upperarm"
 replacebone "ValveBiped.Bip01_R_Bicep" "ValveBiped.Bip01_R_upperarm"
</code></pre>
<p>Starting with LOD 3 and below, you should include removemesh commands to get rid of the eyeballs, transparent materials like glasses, stuff like that. Note that this seems to be bugged with the Orange Box compiler (which sometimes interprets most materials as being named "___error"), in which case you could delete the materials directly on your LOD meshes.
</p>
<h1> <span class="mw-headline" id="Lowest_LODs"> Lowest LODs </span></h1>
<p><b>Recommended distance:</b> 48 (level 4), 64 or more (level 5)
</p>
<pre><code data-language="lua"> replacemodel "my_detailed_mesh.smd" "my_less_detailed_mesh_for_this_lod.smd"  
 $include "../../lowesthumanskeleton.qci"  
 $include "../../lowesthumannohelpers.qci"  
 removemesh "material etc etc"
 removemesh "more materials to remove"
 nofacial
</code></pre>
<h2> <span class="mw-headline" id="Shadow_LOD"> Shadow LOD </span></h2>
<p>This is the LOD used for rendering the render-to-texture shadow. <b>It should always be present</b>, as shadows don't need nearly as much detail as the player models. It should be the same as LOD 4, though (albeit unrecommended) you might want to use the mesh from 3 or maybe even 2.
</p>


